{"version":3,"file":"index.modern.js","sources":["../src/styles.js","../src/index.js"],"sourcesContent":["const pointSize = 50\nconst spanSize = 10\n\nexport default {\n  grid: {\n    width: 'fit-content',\n    userSelect: 'none',\n    position: 'relative',\n    touchAction: 'none'\n  },\n\n  row: {\n    width: 'max-content',\n    fontSize: 0\n  },\n\n  point: {\n    width: pointSize+'px',\n    height: pointSize+'px',\n    display: 'inline-block',\n    margin: '20px',\n  },\n\n  selected_point: {\n    width: '100%',\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n\n  unselected_point: {\n    width: '100%',\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n\n  svg: {\n    position: 'absolute',\n    opacity: 0,\n    top: 0,\n    left: 0,\n    pointerEvents: 'none'\n  },\n\n  pointSpanSelected: {\n    display: 'block',\n    borderRadius: '50%',\n    width: spanSize + 'px',\n    height: spanSize + 'px',\n    backgroundColor: '#000',\n    border: '1px solid #000',\n    touchAction: 'none'\n  },\n\n  pointSpanUnselected: {\n    display: 'block',\n    borderRadius: '50%',\n    width: spanSize + 'px',\n    height: spanSize + 'px',\n    backgroundColor: 'transparent',\n    border: '1px solid #000',\n    touchAction: 'none'\n  }\n}","import React from 'react'\nimport importedstyles from './styles.js'\n\nclass Selection {\n  constructor(){\n    this.init()\n    this.listenersAdded = false\n  }\n\n  init() {\n    this.selected = []\n    this.selectedStates = []\n    this.lines = []\n    this.selecting = false\n    this.linePreviousPoint = []\n    this.currentTouchedPoint = -1\n  }\n\n  start() {\n    this.init()\n\n    this.selecting = true\n    if(!this.listenersAdded){\n      this.listenersAdded = true\n      window.addEventListener('pointerup', () => this.stop())\n      document.querySelector('#__graphic_key_grid').addEventListener('pointermove', e => {\n        if(!this.selecting) { return; }\n        try {\n          let elementFromPoint = document.elementFromPoint(e.pageX - window.pageXOffset, e.pageY - window.pageYOffset)\n          let pointID = elementFromPoint.getAttribute('point-id')\n          if(pointID === null){ return; }\n          if(this.currentTouchedPoint !== pointID && !this.selected.includes(pointID)){\n            let point = refPoints[pointID]\n            let pointNode = refPointsNodes[pointID]\n            let _x = pointNode.current.offsetLeft + pointNode.current.offsetWidth / 2\n            let _y = pointNode.current.offsetTop + pointNode.current.offsetHeight / 2\n            point.current.enable()\n            this.select(pointID, {x: _x, y: _y}, () => point.current.disable())\n          }\n        } catch(e) {}\n      })\n    }\n    this.showLine()\n  }\n\n  showLine() {\n    let svg = svgLineRef.current\n    svg.style.opacity = 1\n    svg.style.width = buttonsRef.current.offsetWidth + 'px'\n    svg.setAttribute('width', buttonsRef.current.offsetWidth)\n    svg.style.height = buttonsRef.current.offsetHeight + 'px'\n    svg.setAttribute('height', buttonsRef.current.offsetHeight)\n  }\n\n  hideLine() {\n    let svg = svgLineRef.current\n    svg.style.opacity = 0\n    svg.style.width = ''\n    svg.style.height = ''\n  }\n\n  processLine() {\n    let lines = this.lines\n    svgLineRef.current.innerHTML = ''\n    if(!styles.hideLine){\n      return;\n    }\n    lines.forEach((line, i) => {\n      let lineNode = document.createElementNS(\"http://www.w3.org/2000/svg\",'line')\n      lineNode.setAttribute('x1', line[0][0])\n      lineNode.setAttribute('y1', line[0][1])\n      lineNode.setAttribute('x2', line[1][0])\n      lineNode.setAttribute('y2', line[1][1])\n      lineNode.setAttribute('stroke', styles.lineColor)\n      lineNode.setAttribute('stroke-width', styles.lineWidth)\n      svgLineRef.current.appendChild(lineNode)\n    })\n  }\n\n  select(id, coordinates, callback) {\n    this.selected.push(id)\n    this.selectedStates.push(callback)\n    let currentPoint = [coordinates.x, coordinates.y]\n    if(this.selected.length > 1){\n      this.lines.push([this.linePreviousPoint, currentPoint])\n    }\n    this.linePreviousPoint = currentPoint\n    this.processLine()\n  }\n\n  stop() {\n    if(!this.selecting) { return; }\n    this.selectedStates.forEach(callback => callback())\n    this.selecting = false\n    this.selected = this.selected.map(el => Number(el))\n    this.selected = [...new Set(this.selected)] // remove duplicates\n    stopCallback(this.selected)\n    this.hideLine()\n  }\n}\n\nlet svgLineRef = React.createRef(null)\nlet buttonsRef = React.createRef(null)\nlet sel = new Selection()\nlet refPoints;\nlet refPointsNodes;\nwindow.expose = () => refPoints\n\nclass Point extends React.Component {\n  constructor(props){\n    super(props);\n    this.id = props['point-id']\n    this.state = {\n      selected: false\n    }\n  }\n\n  enable(){\n    this.setState({selected: true})\n  }\n\n  disable(){\n    this.setState({selected: false})\n  }\n\n  handleStart(e) {\n    this.setState({selected: true})\n    sel.start()\n    sel.select(this.id, this.calculate(e), () => this.setState({selected: false}))\n  }\n\n  handleMouseEnter(e) {\n    if(sel.selecting && !sel.selected.includes(this.id)){\n      this.calculate(e)\n      sel.select(this.id, this.calculate(e), () => this.setState({selected: false}))\n    }\n  }\n\n  calculate(e) {\n    this.setState({selected: true})\n    let _x = e.target.offsetLeft + e.target.offsetWidth / 2\n    let _y = e.target.offsetTop + e.target.offsetHeight / 2\n    return {x: _x, y: _y}\n  }\n\n  handleStop() {\n    sel.stop()\n  }\n\n  render() {\n    return (\n      <div className=\"__graphic_key_point\"\n           onPointerDown={e => this.handleStart(e)}\n           onPointerEnter={e => this.handleMouseEnter(e)}\n           onPointerUp={() => this.handleStop()}\n           style={styles.point}\n           ref={refPointsNodes[this.props['point-id']]}>\n        <div className={this.state.selected?\"__graphic_key_selected_point\":\"__graphic_key_unselected_point\"}\n             style={this.state.selected?styles.selected_point:styles.unselected_point}\n             point-id={this.props['point-id']}>\n             <span style={this.state.selected ? styles.pointSpanSelected : styles.pointSpanUnselected}\n                   point-id={this.props['point-id']}/>\n           </div>\n      </div>\n    )\n  }\n}\n\nfunction PointsRow(props) {\n  return (\n    <div className=\"__graphic_key_row\" style={styles.row}>\n      {props.children}\n    </div>\n  )\n}\n\nfunction Line(){\n  return <svg ref={svgLineRef} style={styles.svg}></svg>\n}\n\nfunction nlsh(first, second, appendToSecond = false) {\n  let result = (first !== null && first !== undefined) ? first : second\n  if(appendToSecond){\n    second = result\n  } else {\n    return result\n  }\n}\n\nlet stopCallback = selected => {}\nlet styles = {};\nlet stylesAssigned = false;\nfunction GraphicKey(props) {\n  const width = nlsh(props.width, 3)\n  const height = nlsh(props.height, 3)\n  stopCallback = nlsh(props.onEnd, selected => {})\n\n  refPoints = Array(width*height).fill().map(() => React.createRef(null))\n  refPointsNodes = Array(width*height).fill().map(() => React.createRef(null))\n\n  if(!stylesAssigned){\n    let stylings = nlsh(props.stylings, {})\n    styles = Object.assign({}, importedstyles)\n    stylesAssigned = true\n    styles.pointSpanSelected.border = nlsh(stylings.borderWidth, 1)+'px solid '+nlsh(stylings.borderColor, '#000')\n    styles.pointSpanUnselected.border = nlsh(stylings.borderWidth, 1)+'px solid '+nlsh(stylings.borderColor, '#000')\n    nlsh(stylings.backgroundColor, styles.pointSpanSelected.backgroundColor, true)\n    nlsh(stylings.backgroundColor, styles.pointSpanUnselected.backgroundColor, true)\n    styles.pointSpanSelected.width = nlsh(stylings.pointSize, 10)+'px'\n    styles.pointSpanSelected.height = nlsh(stylings.pointSize, 10)+'px'\n    styles.pointSpanUnselected.width = nlsh(stylings.pointSize, 10)+'px'\n    styles.pointSpanUnselected.height = nlsh(stylings.pointSize, 10)+'px'\n    nlsh(stylings.pointMargin, styles.point.margin, true)\n    if(stylings.animateOnSelect === false){\n      styles.pointSpanUnselected.backgroundColor = styles.pointSpanSelected.backgroundColor\n    }\n    styles.hideLine = stylings.hideLine === false ? false : true\n    styles.lineColor = nlsh(stylings.lineColor, 'black')\n    styles.lineWidth = nlsh(stylings.lineWidth, 5)\n  }\n\n  const content = Array(height).fill().map((el, i) => {\n    const row = Array(width).fill().map((e, j) => {\n      let pointID = i*width+j\n      return <Point key={j} point-id={pointID} ref={refPoints[pointID]}></Point>\n    })\n\n    return <PointsRow key={i}>{row}</PointsRow>\n  })\n\n  return (\n    <div id=\"__graphic_key_grid\" style={styles.grid}>\n      <div id=\"__graphic_key_svg_line\"><Line /></div>\n      <div id=\"__graphic_key_buttons\" ref={buttonsRef}>{content}</div>\n    </div>\n  )\n}\n\nexport default GraphicKey;\n"],"names":["pointSize","spanSize","grid","width","userSelect","position","touchAction","row","fontSize","point","height","display","margin","selected_point","justifyContent","alignItems","unselected_point","svg","opacity","top","left","pointerEvents","pointSpanSelected","borderRadius","backgroundColor","border","pointSpanUnselected","Selection","constructor","init","listenersAdded","selected","selectedStates","lines","selecting","linePreviousPoint","currentTouchedPoint","start","window","addEventListener","stop","document","querySelector","e","elementFromPoint","pageX","pageXOffset","pageY","pageYOffset","pointID","getAttribute","includes","refPoints","pointNode","refPointsNodes","_x","current","offsetLeft","offsetWidth","_y","offsetTop","offsetHeight","enable","select","x","y","disable","showLine","svgLineRef","style","buttonsRef","setAttribute","hideLine","processLine","innerHTML","styles","forEach","line","i","lineNode","createElementNS","lineColor","lineWidth","appendChild","id","coordinates","callback","push","currentPoint","length","map","el","Number","Set","stopCallback","React","createRef","sel","expose","Point","Component","props","state","setState","handleStart","calculate","handleMouseEnter","target","handleStop","render","PointsRow","children","Line","nlsh","first","second","appendToSecond","result","undefined","stylesAssigned","GraphicKey","onEnd","Array","fill","stylings","Object","assign","importedstyles","borderWidth","borderColor","pointMargin","animateOnSelect","content","j"],"mappings":"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"}