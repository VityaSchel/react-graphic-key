{"version":3,"file":"index.js","sources":["../src/styles.js","../src/index.js"],"sourcesContent":["const pointSize = 50\nconst spanSize = 10\n\nexport default {\n  grid: {\n    width: 'fit-content',\n    userSelect: 'none',\n    position: 'relative'\n  },\n\n  row: {\n    width: 'fit-content',\n    fontSize: 0\n  },\n\n  point: {\n    width: pointSize+'px',\n    height: pointSize+'px',\n    display: 'inline-block',\n    margin: '20px',\n  },\n\n  selected_point: {\n    width: '100%',\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n\n  unselected_point: {\n    width: '100%',\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n\n  svg: {\n    position: 'absolute',\n    opacity: 0,\n    top: 0,\n    left: 0,\n    pointerEvents: 'none'\n  },\n\n  pointSpanSelected: {\n    display: 'block',\n    borderRadius: '50%',\n    width: spanSize + 'px',\n    height: spanSize + 'px',\n    backgroundColor: '#000',\n    border: '1px solid #000'\n  },\n\n  pointSpanUnselected: {\n    display: 'block',\n    borderRadius: '50%',\n    width: spanSize + 'px',\n    height: spanSize + 'px',\n    backgroundColor: 'transparent',\n    border: '1px solid #000'\n  }\n}","import React from 'react'\nimport importedstyles from './styles.js'\n\nclass Selection {\n  constructor(){\n    this.init()\n  }\n\n  init() {\n    this.selected = []\n    this.selectedStates = []\n    this.lines = []\n    this.selecting = false\n    this.linePreviousPoint = []\n  }\n\n  start() {\n    this.init()\n\n    this.selecting = true\n    window.addEventListener('mouseup', () => this.stop())\n    this.showLine()\n  }\n\n  showLine() {\n    let svg = svgLineRef.current\n    svg.style.opacity = 1\n    svg.style.width = buttonsRef.current.offsetWidth + 'px'\n    svg.setAttribute('width', buttonsRef.current.offsetWidth)\n    svg.style.height = buttonsRef.current.offsetHeight + 'px'\n    svg.setAttribute('height', buttonsRef.current.offsetHeight)\n  }\n\n  hideLine() {\n    let svg = svgLineRef.current\n    svg.style.opacity = 0\n    svg.style.width = ''\n    svg.style.height = ''\n  }\n\n  processLine() {\n    let lines = this.lines\n    svgLineRef.current.innerHTML = ''\n    if(!styles.hideLine){\n      return;\n    }\n    lines.forEach((line, i) => {\n      let lineNode = document.createElementNS(\"http://www.w3.org/2000/svg\",'line')\n      lineNode.setAttribute('x1', line[0][0])\n      lineNode.setAttribute('y1', line[0][1])\n      lineNode.setAttribute('x2', line[1][0])\n      lineNode.setAttribute('y2', line[1][1])\n      lineNode.setAttribute('stroke', styles.lineColor)\n      lineNode.setAttribute('stroke-width', styles.lineWidth)\n      svgLineRef.current.appendChild(lineNode)\n    })\n  }\n\n  select(id, coordinates, callback) {\n    this.selected.push(id)\n    this.selectedStates.push(callback)\n    let currentPoint = [coordinates.x, coordinates.y]\n    if(this.selected.length > 1){\n      this.lines.push([this.linePreviousPoint, currentPoint])\n    }\n    this.linePreviousPoint = currentPoint\n    this.processLine()\n  }\n\n  stop() {\n    if(!this.selecting) { return; }\n    this.selectedStates.forEach(callback => callback())\n    this.selecting = false\n    stopCallback(this.selected)\n    this.hideLine()\n  }\n}\n\nlet svgLineRef = React.createRef(null)\nlet buttonsRef = React.createRef(null)\nlet sel = new Selection()\n\nclass Point extends React.Component {\n  constructor(props){\n    super(props);\n    this.id = props['point-id']\n    this.state = {\n      selected: false\n    }\n  }\n\n  handleStart(e) {\n    this.setState({selected: true})\n    sel.start()\n    sel.select(this.id, this.calculate(e), () => this.setState({selected: false}))\n  }\n\n  handleMouseEnter(e) {\n    if(sel.selecting && !sel.selected.includes(this.id)){\n      this.calculate(e)\n      sel.select(this.id, this.calculate(e), () => this.setState({selected: false}))\n    }\n  }\n\n  calculate(e) {\n    this.setState({selected: true})\n    let _x = e.target.offsetLeft + e.target.offsetWidth / 2\n    let _y = e.target.offsetTop + e.target.offsetHeight / 2\n    return {x: _x, y: _y}\n  }\n\n  handleStop() {\n    sel.stop()\n  }\n\n  render() {\n    return (\n      <div className=\"__graphic_key_point\" onMouseDown={(e) => this.handleStart(e)} onMouseEnter={(e) => this.handleMouseEnter(e)}\n           onMouseUp={() => this.handleStop()} style={styles.point}>\n        <div className={this.state.selected?\"__graphic_key_selected_point\":\"__graphic_key_unselected_point\"}\n             style={this.state.selected?styles.selected_point:styles.unselected_point}>\n             <span style={this.state.selected ? styles.pointSpanSelected : styles.pointSpanUnselected}/>\n           </div>\n      </div>\n    )\n  }\n}\n\nfunction PointsRow(props) {\n  return (\n    <div className=\"__graphic_key_row\" style={styles.row}>\n      {props.children}\n    </div>\n  )\n}\n\nfunction Line(){\n  return <svg ref={svgLineRef} style={styles.svg}></svg>\n}\n\nfunction nlsh(first, second, appendToSecond = false) {\n  let result = (first !== null && first !== undefined) ? first : second\n  if(appendToSecond){\n    second = result\n  } else {\n    return result\n  }\n}\n\nlet stopCallback = selected => {}\nlet styles = {};\nlet stylesAssigned = false;\nfunction GraphicKey(props) {\n  const width = nlsh(props.width, 3)\n  const height = nlsh(props.height, 3)\n  stopCallback = nlsh(props.onEnd, selected => {})\n\n  if(!stylesAssigned){g\n    let stylings = nlsh(props.stylings, {})\n    styles = Object.assign({}, importedstyles)\n    stylesAssigned = true\n    styles.pointSpanSelected.border = nlsh(stylings.borderWidth, 1)+'px solid '+nlsh(stylings.borderColor, '#000')\n    styles.pointSpanUnselected.border = nlsh(stylings.borderWidth, 1)+'px solid '+nlsh(stylings.borderColor, '#000')\n    nlsh(stylings.backgroundColor, styles.pointSpanSelected.backgroundColor, true)\n    nlsh(stylings.backgroundColor, styles.pointSpanUnselected.backgroundColor, true)\n    styles.pointSpanSelected.width = nlsh(stylings.pointSize, 10)+'px'\n    styles.pointSpanSelected.height = nlsh(stylings.pointSize, 10)+'px'\n    styles.pointSpanUnselected.width = nlsh(stylings.pointSize, 10)+'px'\n    styles.pointSpanUnselected.height = nlsh(stylings.pointSize, 10)+'px'\n    nlsh(stylings.pointMargin, styles.point.margin, true)\n    if(stylings.animateOnSelect === false){\n      styles.pointSpanUnselected.backgroundColor = styles.pointSpanSelected.backgroundColor\n    }\n    styles.hideLine = stylings.hideLine === false ? false : true\n    styles.lineColor = nlsh(stylings.lineColor, 'black')\n    styles.lineWidth = nlsh(stylings.lineWidth, 5)\n  }\n\n  const content = Array(height).fill().map((el, i) => {\n    const row = Array(width).fill().map((e, j) => <Point key={j} point-id={i*width+j}></Point>)\n\n    return <PointsRow key={i}>{row}</PointsRow>\n  })\n\n  return (\n    <div id=\"__graphic_key_grid\" style={styles.grid}>\n      <div id=\"__graphic_key_svg_line\"><Line /></div>\n      <div id=\"__graphic_key_buttons\" ref={buttonsRef}>{content}</div>\n    </div>\n  )\n}\n\nexport default GraphicKey;\n"],"names":["pointSize","spanSize","grid","width","userSelect","position","row","fontSize","point","height","display","margin","selected_point","justifyContent","alignItems","unselected_point","svg","opacity","top","left","pointerEvents","pointSpanSelected","borderRadius","backgroundColor","border","pointSpanUnselected","Selection","init","selected","selectedStates","lines","selecting","linePreviousPoint","start","window","addEventListener","stop","showLine","svgLineRef","current","style","buttonsRef","offsetWidth","setAttribute","offsetHeight","hideLine","processLine","innerHTML","styles","forEach","line","i","lineNode","document","createElementNS","lineColor","lineWidth","appendChild","select","id","coordinates","callback","push","currentPoint","x","y","length","stopCallback","React","createRef","sel","Point","props","state","handleStart","e","setState","calculate","handleMouseEnter","includes","_x","target","offsetLeft","_y","offsetTop","handleStop","render","Component","PointsRow","children","Line","nlsh","first","second","appendToSecond","result","undefined","stylesAssigned","GraphicKey","onEnd","g","stylings","Object","assign","importedstyles","borderWidth","borderColor","pointMargin","animateOnSelect","content","Array","fill","map","el","j"],"mappings":"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"}